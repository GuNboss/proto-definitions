syntax = "proto3";
package oepackage;

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";


service ElementService {
    rpc listElement(ListElementRequest)
    returns(ListElementResponse) {
    }

    rpc getElements(GetElementsRequest)
    returns(GetElementsResponse) {
    }


    rpc listConfiguration(ListConfigurationRequest)
    returns(ListConfigurationResponse) {
    }

    rpc getConfigurations(GetConfigurationsRequest)
    returns(stream GetConfigurationsResponse) {
    }

    rpc getConfigurationsModifiedSince(Timestamp)
    returns(stream GetConfigurationsModifiedResponse) {
    }


    rpc getAlarms(GetAlarmsRequest)
    returns(stream GetAlarmsResponse) {
    }

    rpc getAlarmsModifiedSince(Timestamp)
    returns(stream GetAlarmsResponse) {
    }


    rpc getLogs(GetLogsRequest) 
    returns(stream GetLogsResponse) {
    }

    rpc getLogsModifiedSince(Timestamp)
    returns(stream GetLogsResponse) {
    }


    rpc listType(ListTypeRequest)
    returns(ListTypeResponse) {
    }

    rpc getTypes(GetTypesRequest)
    returns(GetTypesResponse) {
    }


    rpc listCommand(ListCommandRequest)
    returns(ListCommandResponse) {
    }

    rpc getCommands(GetCommandsRequest)
    returns(GetCommandsResponse) {
    }

    rpc runCommand(RunCommandRequest)
    returns(RunCommandResponse) {
    }
}


message ListElementRequest {
    oneof request_filter {
        Element         element         = 1;
    }
}
message ListElementResponse {
    repeated ElementID  elements = 1;
}

message GetElementsRequest {
    oneof request_filter {
        Element         element         = 1;
    }
}
message GetElementsResponse {
    repeated Element    elements = 1;
}


message ListConfigurationRequest {
    oneof request_filter {
        Configuration   configuration   = 1;
        Element         element         = 2;
    }
}
message ListConfigurationResponse {
    repeated ConfigurationID configurations = 1;
}

message GetConfigurationsRequest {
    oneof request_filter {
        Configuration   configuration   = 1;
        Element         element         = 2;
        Timestamp       modifiedSince   = 3;
    }
}
message GetConfigurationsResponse {
    repeated Configurations response = 1;

    message Configurations {
        ElementID               element         = 1;
        repeated Configuration  configurations  = 2;
    }
}
message GetConfigurationsModifiedResponse {
    repeated Configurations response = 1;

    message Configurations {
        ElementID               element         = 1;
        repeated Configuration  configurations  = 2;
    }
}


message GetAlarmsRequest {
    oneof request_filter {
        Alarm           alarm           = 1;
        Element         element         = 2;
        Timestamp       modifiedSince   = 3;
    }
}
message GetAlarmsResponse {
    repeated Alarms response = 1;

    message Alarms {
        ElementID       element = 1;
        repeated Alarm  alarms  = 2;
    }
}


message GetLogsRequest {
    oneof request_filter {
        Log             log             = 1;
        Element         element         = 2;
        Timestamp       modifiedSince   = 3;
    }
}
message GetLogsResponse {
    repeated Logs response = 1;

    message Logs {
        ElementID       element = 1;
        repeated Log    logs    = 2;
    }
}


message ListTypeRequest {
    oneof request_filter {
        Type            type            = 1;
    }
}
message ListTypeResponse {
    repeated TypeID types = 1;
}

message GetTypesRequest {
    oneof request_filter {
        Type            type            = 1;
    }
}
message GetTypesResponse {
    repeated Type types = 1;
}


message ListCommandRequest {
    oneof request_filter {
        Command         command         = 1;
        Element         element         = 2;
    }
}
message ListCommandResponse {
    repeated CommandID  commands = 1;
}

message GetCommandsRequest {
    oneof request_filter {
        Command         command         = 1;
        Element         element         = 2;
    }
}
message GetCommandsResponse {
    repeated Command    commands = 1;
}

message RunCommandRequest {
    CommandID   command = 1;
    ElementID   element = 2;
    repeated RunCommandParameter parameters = 3;

    message RunCommandParameter {
        string name = 1;
        string value = 2;
    }
}
message RunCommandResponse {
    string      result = 1;
}


message Element {
    string id               = 1;
    string name             = 2;
    string type             = 3;
    string model            = 4;
    string version          = 5;
    string serverAddress    = 7;
    string status           = 8;
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;


    /// Element Identifier
    message ElementID {
        string id = 1;
    }
}


message Configuration {
    string id           = 1;
    string parent       = 2;
    string name         = 3;
    string value        = 4;
    string description  = 5;
    TypeID type         = 6;
    Timestamp last_modified = 7;
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;

    /// Configuration Identifier
    message ConfigurationID {
        string id = 1;
    }
}


/** https://cwmp-data-models.broadband-forum.org/cwmp-datamodel-1-14.xsd:123
    <xs:simpleType name="BuiltinTypeName">
        <xs:annotation>
            <xs:documentation>
                Built-in type name.
                The type hierarchy is as for XML Schema, with "any" and "base64" mapping to the "anySimpleType" and "base64Binary" XML Schema types respectively.
            </xs:documentation>
        </xs:annotation>
        <xs:restriction base="tns:String">
            <xs:enumeration value="any"/>
            <xs:enumeration value="base64"/>
            <xs:enumeration value="boolean"/>
            <xs:enumeration value="dateTime"/>
            <xs:enumeration value="decimal"/>
            <xs:enumeration value="hexBinary"/>
            <xs:enumeration value="integer"/>
            <xs:enumeration value="int"/>
            <xs:enumeration value="long"/>
            <xs:enumeration value="string"/>
            <xs:enumeration value="unsignedInt"/>
            <xs:enumeration value="unsignedLong"/>
        </xs:restriction>
    </xs:simpleType>
  */
enum TYPE_CWMP_BUILTIN {
    base64          = 0x01;
    boolean         = 0x02;
    dateTime        = 0x03;
    decimal         = 0x04;
    hexBinary       = 0x05;
    integer         = 0x06;
    int             = 0x07;
    long            = 0x08;
    string          = 0x09;
    unsignedInt     = 0x0A;
    unsignedLong    = 0x0B;
}

enum TYPE_YANG_BUILTIN {
    string          = 0x01;
    boolean         = 0x02;
    enumeration     = 0x03;
    bits            = 0x04;
    binary          = 0x05;
    empty           = 0x06;
    int8            = 0x11;
    int16           = 0x12;
    int32           = 0x14;
    int64           = 0x18;
    uint8           = 0x21;
    uint16          = 0x22;
    uint32          = 0x24;
    uint64          = 0x28;
    decimal64       = 0x38;
}

message Type {
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;
    string  id      = 1;
    bool    config  = 2;
    string  default = 3;
    string  units   = 4;
    string  range   = 5;
    string  length  = 6;
    string  pattern = 7;
    string  description = 8;

    repeated TypeEnum enums = 10;

    oneof type_native {
        TYPE_CWMP_BUILTIN    type_cwmp  = 101;
        TYPE_YANG_BUILTIN    type_yang  = 102;
    }

    /// Type Identifier
    message TypeID {
        string id = 1;
    }
    message TypeEnum {
        string name = 1;
        string value = 2;
    }
}


message Command {
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;
    string id = 1;
    repeated CommandParameter parameters = 2;

    /// Command Identifier
    message CommandID {
        string id = 1;
    }
    message CommandParameter {
        string  optionality     = 1;
        TypeID  type            = 2;
        string  name            = 3;
    }
}


message Alarm {
    oneof alarm_type {
        GenericAlarm    generic_alarm           =1;
        CurrentAlarm    current_alarm           =2;    
    }
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;


    //// Embedded Messages ////
    message GenericAlarm {
        string element_id               =1;
        string alarm_code               =2;
        string event_time               =3;
        string severity                 =4;
        string alarm_type               =5;
    }
    message CurrentAlarm {
        string element_id               = 1;
        string element_name             = 2;
        string alarm_code               = 3;
        string alarm_raised_time        = 4;
        string event_time               = 5;
        string alarm_type               = 6;
        string isACK                    = 7;
        string alarm_loc                = 8;
        string severity                 = 9;
        string report_mechanism         = 10;
        string probable_cause           = 11;
        string specific_problem         = 12;
        string additional_text          = 13;
        string additional_information   = 14;
    }
}


message Log {
    string date = 1;
    oneof log_type {
        GenericLog      generic_log             =2;
        //OAM LOG
        OperationLog    operation_log           =3;
        WebLog          web_log                 =4;
        FaultLog        oam_fault_log           =5;
        //EMS LOG
        EventLog        event_log               =6;
        CLILog          cli_log                 =7;
        NodeBLog        nodeb_log               =8;
        CurrentLog      ems_fault_log           =9;
    }
    map<string,string> labels   = 1001;
    map<string,string> extra    = 1111;


    //// Embedded Messages ////
    message EventLog {
        string idx                  =1;
        string element_id           =2;
        string event_type           =3;
        string event_code           =4;
        string event_code_name      =5;
        string event_head_str       =6;
        string event_logfile_name   =7;
        string context              =8;
    }
    message CurrentLog {
        string alarm_history_no     =1;
        string element_id           =2;
        string alarm_code           =3;
        string alarm_changed_time   =4;
        string alarm_cleared_time   =5;
        string event_time           =6;
        string alarm_type           =7;
        string alarm_state          =8;
        string alarm_loc            =9;
        string severity             =10;
        string report_mechanism     =11;
        string probable_cause       =12;
        string specific_problem     =13;
        string additional_text      =14;
        string additional_information =15;
    }
    message CLILog {
        string command_history_no       =1;
        string command_id               =2;
        string command_alias            =3;
        string user_id                  =4;
        string user_ip                  =5;
        string element_id               =6;
        string request_time             =7;
        string response_time            =8;
        string result                   =9;
        string fail_reason              =10;
        string command_head_str         =11;
        string command_logfile_name     =12;
        string context                  =13;
        string transaction_id           =14;
    }
    message NodeBLog {
        string device_history_no        =1;
        string element_id               =2;
        string hems_id                  =3;
        string serial_number            =4;
        string oui                      =5;
        string element_name             =6;
        string device_type_id           =7;
        string operation_flag           =8;
        string operation_time           =9;
        string operation_user_id        =10;
    }
    message GenericLog {
        string timestamp    = 1;
        string source       = 2;
        string level        = 3;
        string message      = 4;
    }
    message OperationLog {
        string idx          = 1;
        string module       = 2;
        string message      = 3;
        string level        = 4;
    }
    message WebLog {
        string idx          = 1;
        string user_name     = 2;
        string event        = 3;
    }
    message FaultLog {
        string idx          = 1;
        string module       = 2;
        string code         = 3;
        string event        = 4;
        string message      = 5;
        string level        = 6;
        string read_check   = 7;
    }
}
